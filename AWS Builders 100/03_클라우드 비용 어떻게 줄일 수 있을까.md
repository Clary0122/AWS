# 클라우드 비용 어떻게 줄일 수 있을까
## 비용 데이터 수집
### 데이터 확인
#### 1. Billing Dashboard
- AWS 클라우드 전반적인 비용 확인
- 전체 지출의 대부분 사용하는 서비스가 무엇인지, 전 달 대비 얼마나 사용하고 있는지 확인 가능
#### 2. Bills
- 왼쪽 상단 **청구서(Bills)** 서비스 별로 과금 된 서비스를 월 별로 확인 가능
#### 3. Reports
- 비용 및 사용량 보고서(Cost and Usage Report, CUR) : 시간 당 비용 세분화

### 툴
#### 4. Trusted Advisore
- 전반적인 인프라 환경을 점검해주는 서비스
- 5가지 분야 : 비용 최적화, 성능, 보안, 내결함성, 서비스 한도

#### 5. Cost Explorer (비용탐색기)
- AWS 비용을 시각화 해서 빠르게 문제점을 찾아주는 서비스

> #### 여기까지로 서비스 별 비용 확인, 불필요 자원 유무를 확인 가능하지만 해당 리소스의 주인이 누구인지 어떠한 목적으로 사용되고 있는 지 등은 확인 불가.

### 정책
#### 6. 태깅
![image](https://user-images.githubusercontent.com/79209568/166418746-f8c666bf-5379-4265-b02c-0855c24541d1.png)
- 클라우드 비용도 해당 리소스를 어느 팀에서 어떠한 목적으로 사용하고 있는지 볼 수 있는 것이 매우 중요
- AWS는 거의 모든 리소스에 key, value로 태깅이 가능
- 프로젝트 시작 전, 팀원들과 태깅 정책을 세워서 리소스가 어디에 속하는 지 확인하고 체계적으로 관리하는 것이 중요

## 비용 줄이기
### Rightsizing
#### 인스턴스 사이즈
- 과거 On-premise 환경에서는 최대를 예상하고 리소스를 크게 잡아 구축했지만 On-demand 환경인 클라우드에서는 auto-scailing과 같은 서비스를 사용해 수요와 맞춰 인스턴스 확장이 가능
- rightsizing 검사 방법
  - 테스트 환경에서 최소한의 인스턴스를 시작
  - `Amazon CloudWatch`와 같은 모니터링 툴을 이용해 CPU나 다른 매출정보를 확인하여 사이즈 변경
#### 인스턴스 타입
- 워크로드에 맞는 인스턴스 타입을 선택  
![image](https://user-images.githubusercontent.com/79209568/166421070-c5ad4023-a60c-4c15-8c32-0396a4e0a913.png)  
- 범용 인스턴스인 **M**으로 시작 혹은 **T** → 테스트로 사용해보기
- CPU를 많이 사용한다? → **C**
- 메모리가 많이 필요하다? → **R**

### Elasticity
#### 인스턴스 스케줄링
- 인스턴스를 오래 켜둘수록 과금되기 때문에 안 쓸때는 꺼두어야한다.
- **AWS Instance Scheduler** : 스케줄링 자동화 서비스
  - 두 개의 DynamoDB가 자동으로 생성됨
  - config 테이블에서 시간과 요일 등 기본적인 설정이 가능
  - 설정 완료 후 종료하고 싶은 인스턴스에 태깅을 하면 Instance Scheduler가 태깅을 보고 설정해놓은 값에따라 중지를 진행
  - 예) 월-금, 9:00-18:00 동안만 'Schedule' 태그의 인스턴스가 사용되도록 설정  
    ![image](https://user-images.githubusercontent.com/79209568/166422357-2d14c4c4-0168-4986-acb9-6e9bc2391cab.png)  
 
### Pricing
- 가격 옵션을 선택해서 비용을 줄일 수 있다.
- 온디맨드, 예약 인스턴스, 스팟 인스턴스  
[ㄷ**01_AWS와 함께하는 클라우드 컴퓨팅**의 **과금 옵션 및 비용 최적화**에서 정리](https://github.com/Clary0122/AWS/blob/main/AWS%20Builders%20100/01_AWS%EC%99%80%20%ED%95%A8%EA%BB%98%ED%95%98%EB%8A%94%20%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C%20%EC%BB%B4%ED%93%A8%ED%8C%85.md#amazon-ec2)

#### 온디맨드
- 사용한 만큼 지불하는 기본옵션
#### 예약 인스턴스(Reserved Instance)
- 물리적 인스턴스가 **아닌!** 온디맨드 인스턴스를 사용할 때 적용되는 할인 쿠폰 개념과 같음
- 크게 세 가지로 











