# OSI 7 Layers
> Please Do Not Touch Steve's Pet Alligator
- 네트워크에서 통신이 일어나는 과정을 7단께로 나눈 것
- 통신이 일어나는 과정을 단계별로 파악 가능
- 7 단계 중 특정한 곳에 이상이 생기면 다른 단계의 장비 및 소프트웨어를 건들이지 않고도 이상이 생긴 단계만 고칠 수 있음
## 종류
```
1  Physical - 물리 (케이블, 리피터, 허브)
2  Datalink - 데이터링크 (Ethernet, Frame Relay)
3  Network - 네트워크 (IP)
4  Transport - 전송 (TCP, UDP, SCTP)
5  Session - 세션 (NetBIOS, SAP, SDP)
6  Presentation - 표현 (ASCII, MPEG, JPEG, MIDI)
7  Application - 응용 (HTTP, FTP, SMTP, Telnet)
```
### 1계층 - 물리계층(Physical Layer)
- 주로 전기적, 기계적, 기능적인 특성을 이용해서 통신 케이블로 데이터를 전송
- 통신 단위 : 1 0 (즉, 전기적 온오프)00
- 단지 데이터 전달 목표. 데이터가 무엇인지, 에러가 있는지는 신경 X
- 대표적 장비 : 통신 케이블, [리피터](#리피터), [허브](#허브)

### 2계층 - 데이터링크계층(DataLink Layer)
- 물리계층을 통해 송수신되는 데이터의 오류와 흐름을 관리하여 안전한 정보의 전달을 수행하도록 도와주는 역할
- 네트워크 기기 간의 데이터 전송, 물리주소 결정, 네트워크 장비 간에 신호를 주고받는 규칙 지정
- 통신 단위 : [**프레임**](#프레임)
- MAC(Media Access Control Address; 랜카드에 할당된 유일한 번호)주소를 사용한 통신
- 대표적 프로토콜 : [이더넷](#이더넷)
- 대표적 장비 : [스위치](#스위치), [브릿지](#브릿지)

### 3계층 - 네트워크계층(Network Layer)
- 서로 다른 네트워크에 있는 목적지로 데이터를 안전하고 빠르게 전송하는 기능
- 이전 데이터링크 계층은 같은 네트워크 즉, 같은 랜 내에서 이더넷 규칙으로 데이터를 전송. 그러나 인터넷이나 다른 네트워크로는 데이터 전송 불가
- 대표적 프로토콜 : [IP](#IP), 
ICMP(패킷전달 에러의 보고 및 진단), 
라우팅(복잡한 네트워크에서 인터네트워킹을 위한 경로를 찾게해줌)
- 대표적 장비 : [라우터](#라우터)

### 4계층 - 전송계층(Transport Layer)
- 목적지까지 신뢰할 수 있는 데이터를 전달하기 위해 오류 점검(오류 시 재전송 요청), 전송된 데이터의 목적지가 어떤 어플리케이션인지 식별 
- 두 가지 통신 방법이 있다.
  - **연결형 통신** : 신뢰성, 정확성을 위해 여러번 확인 후 데이터를 보냄, [TCP](#TCP) 프로토콜 사용
    - 3-way handshake 
      ```
      (A,B 컴퓨터 끼리 통신) 
      연결확립 A:SYN -> B:SYN+ACK -> A:ACK  
      연결종료 A:FIN -> B:ACK -> B:FIN -> A:ACK
      ```
    - 일련번호와 확인 응답 번호
      ```
      - 3-way handshake가 끝나고 데이터를 주고 받을 때 사용
      - 일련번호 : 송신 측에서 수신 측에 이 데이터가 몇 번째 데이터인지 알려주는 역할 (수신측은 원래 데이터의 몇 번째 데이터를 받았는지 알 수 있음)
      - 확인 응답 번호 : 수신 측이 몇 번째 데디터를 수신했는지 송신 측에 알려주는 역할 (받은 데이터의 다음 번호의 데이터를 요청하는 데 사용)
      - 재전송 제어 : 이 두 정보를 사용해서 데이터가 손상되거나 유실된 경우 재전송하는 기능
      ```
      ![image](https://user-images.githubusercontent.com/79209568/168529757-57799d46-fce2-46c2-a162-386ad6ba0ced.png)
      - 확인 응답을 받기 전에 **세그먼트를 연속해서 보내는 방법**을 사용
    - 포트번호 : 각 어플리케이션이 가지고 있는 번호로 어플리케이션을 구분하는 데 사용
  - **비연결형 통신** : 빠르고 효율적으로 전달하기 위해 확인 절차 없이 일방적으로 데이터 보냄, [UDP](#UDP) 프로토콜 사용  
![image](https://user-images.githubusercontent.com/79209568/168526698-3bcfe6fd-3edc-4944-993c-f133be2b7eb9.png)


<hr>

> #### 허브
> - 다수의 PC와 장치들을 묶어서 LAN을 구성할 때 각각의 PC에 연결된 노드들을 한 곳으로 모으는 역할을 해주는 장치
> - 중심 축에서 여러 컴퓨터들을 연결하여 네트워크를 만들어주는 역할
> - 단순히 중계기 역할을 하고 하나에 컴퓨터에서 신호를 보내면 그 신호를 연결된 모든 컴퓨터로 전송함(브로드캐스트)
> ##### 허브의 종류
> - **더미 허브** 
>   - pc와 pc를 연결시켜주는 일반적인 기능을 하는 허브
>   - 허브에 전달되는 데이터를 모든 컴퓨터로 전달
>   - 이 때 허브에 연결된 다른 pc들은 통신할 수 없고, 데이터 전송이 끝날 때까지 기다려야 함
> - **스위칭 허브**
>   - 더미 허브의 단점을 개선한 허브
>   - 데이터링크 계층(2계층)에서 동작
>   - 데이터를 모든 pc에 전송하지 않고, 순간순간 포트를 스위칭해서 목적지에만 전달
>   - 각 포트마다 전용 할당 가능
> - **인텔리전트 허브**
>   - 더미 허브에서 NMS(Network Management System; 네트워크 관리 시스템) 기능이 추가된 허브
>   - 모든 데이터를 분석 및 제어 가능
>   - 망 관리 기능, 문제 pc와 연결된 포트를 찾아내서 방출 시키는 Isolation 기능 

> #### 리피터
> - 신호를 수신하여 신호를 증폭한 후 다음 구간으로 재전송하는 장치
> - 근거리 통신망을 구성하는 세그먼트들을 확장하거나 서로 연결하는데 주로 사용
> - 전자기장 확산이나 케이블 손실로 인한 신호 감쇠를 보상 -> 여러대의 리피터를 써서 신호(데이터)를 먼 거리까지 전달 가능

> #### 이더넷
> - 렌에서 데이터를 주고받기 위한 규칙이며 일반적으로 사용하는 랜에서 가장 많이 활용되는 기술 규격
> - 허브와 같은 장비에 연결된 컴퓨터와 데이터를 주고받을 때 사용
> - 이더넷 헤더 : 총 14 bytes로 구성
>   - 목적지의 MAC 주소, 출발지 MAC 주소, 유형  
>     ![image](https://user-images.githubusercontent.com/79209568/168508745-6dd8a6a4-2365-456d-a776-420a35bcb75a.png)
> - 트레일러 : 데이터 뒤에 붙고, FCS(Frame Check Sequence)라고도 부름, 데이터 전송 도중 오류가 발생하는지 확인

> #### 프레임
> - Local Area Network의 경우
>   - 물리계층에서 받아온 비트 스트림을 나눔  
>   ![image](https://user-images.githubusercontent.com/79209568/168507960-02a5a6b3-9891-46d8-b904-653dee2bd2f3.png)
> - 장거리 통신의 경우
>   - **이더넷 헤더 + 트레일러**가 추가된 데이터

> #### 스위치
> - 랜을 구성할 때 사용하는 단말기 간 스위칭 기능이 있는 통신망 중계 장치
> ##### 허브말고 스위치를 이용해야하는 이유
> - 데이터 통신 방식
>   - 데이터 통신 방식에는 **전이중 통신방식**(데이터의 송수신을 동시에 통신하는 방식)과 **반이중 통신방식**(회선 하나로 송수신을 번갈아가며 통신하는 방식) 두 가지가 있다
>   - 허브: 송수신이 나눠지지 않아서 동시에 데이터를 전송하면 충돌이 발생하기 때문에 반이중 통신방식 사용
>   - 스위치: 충돌이 일어나지 않는 구조로 되어있기 때문에 전이중 통신방식을 사용
> - 충돌 도메인
>   - 충돌이 발생할 때 그 영향이 미치는 범위
>   - 허브: 연결된 모든 컴퓨터가 하나의 충돌 도메인 됨
>   - 스위치: 컴퓨터와 연결된 포트만이 충돌 도메인이 됨
> - **효율이 좋고 네트워크 지연 경우가 더 적은 스위치를 사용하는 것이 표준**

> #### 브릿지
> - 스위치와 비슷한 역할
> - 최근에는 대부분 스위치를 씀
> - 처리방식 차이
>   - 스위치는 하드웨어 처리방식, 브리지는 소프트웨어 처리방식이기 때문에 스위치의 속도가 훨씬 빠름
> - 포트 별 속도 차이
>   - 브리지의 포트들은 모두 같은 속도 지원, 스위치는 서로 다른 속도 지원
> - 기능 차이
>   - 스위치는 cut-through or store-and-forward 방식 지원, 브리지는 store-and-forward 방식만 지원
>   - store-and-forward : 포트로 패킷을 받으면 정상저긍로 들어왔는지, 에러가 없는지, 주소는 뭔지를 파악. 에러 발생 시 해당 패킷을 버리고 재 전송 요구
>   - cut-Throught : 패킷의 목적지 주소만을 본 후 바로 전송 처리. 속도가 빠르지만 에러처리 부족

> #### 라우터
> - 네트워크 간의 통신을 위해 다른 네트워크로 데이터를 전송하는 네트워크 장비
> - IP주소로 목적지 지정, 목적지까지 데이터를 보낼 경로 지정

> #### IP
> - 패킷 전달을 책임지는 프로토콜
> - IP주소 : 어떤 네트워크의 컴퓨터인지 구분할 수 있는 논리적 주소
> - IPv4와 IPv6가 있음
> - 공인 IP주소와, 사설 IP주소가 있음. IP주소는 인터넷 서비스 제공자(ISP)에게서 받을 수 있는데 ISP가 제공하는 것이 공인IP주소이다.  
>   ![image](https://user-images.githubusercontent.com/79209568/168521267-6819376c-88f1-496f-8ae9-85234baadc6e.png)
> ##### IP주소 클래스
> - 네트워크 ID, 호스트 ID로 나눠져 있음.
> - 네트워크 ID는 어떤 네트워크인지, 호스트 ID는 해당 네트워크에서 어떤 컴퓨터인지  
>   ![image](https://user-images.githubusercontent.com/79209568/168521356-a3593b7b-5f9b-4f30-bea9-52a600da2d15.png)
> ##### 네트워크 주소, 브로드캐스트 주소
> - 네트워크 주소
>   - 호스트 ID가 0인 주소
>   - 작은 네트워크를 대표하는 주소로 네트워크를 식별하기 위해 사용
>   - **예)** 192.168.1.1, 192.168.1.2, 192.168.1.3의 IP주소를 가지는 PC는 192.168.1.0의 네트워크에 있다고 볼 수 있음
> - 브로드캐스트 주소
>   - 호스트 ID가 255 주소
>   - 네트워크에 있는 장비 모두에게 한 번에 데이터를 전송하는 데 사용되는 IP 주소
>   - **예)** 192.168.1.255로 데이터를 전송하면 네트워크 내에 모든 pc로 데이터가 전송 됨

> #### TCP
> ##### 세그먼트
> - TCP로 데이터 전송 시 하위계층에서 받아온 데이터에 붙이는 헤더를 **TCP 헤더**라고 함.
> - 이 TCP 헤더가 붙은 데이터를 세그먼트라고 함
> - TCP 헤더 내의 **코드 비트**는 연결의 제어 정보가 기록 됨
>   - URG: 긴급 데이터가 들어있는 것을 나타내는 플래그
>   - ACK: 유효한 ACK번호가 TCP 헤더에 있는 것을 나타내는 플래그. 3-way handshake 시 최초를 제외한 다른 모든 TCP 패킷은 이 플래그가 ON 되어있음
>   - PSH: 받은 데이터를 즉시 응용 프로그램에 전달할 것을 요구하는 플래그
>   - RST: TCP 연결을 중단, 거부하고 싶은 경우에 설정되는 플래그(강제종료)
>   - SYN: 3-way handshake 시 오픈처리를 시작하는 쌍방의 각 SYN 플래그를 ON 하여 ACK 번호를 동기화
>   - FIN: TCP 연결을 종료하기 위해 양쪽에서 FIN 플래그를 ON하면 종료

> #### UDP
> ##### UDP 데이터그램
> - UDP는 신뢰성과 정확성이 필요하지 않기 때문에 작은 크기의 UDP 헤더를 가짐
> - 이 UDP헤더가 붙은 데이터를 UDP 데이터그램이라고 함
